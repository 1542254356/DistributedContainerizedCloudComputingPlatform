# 接口文档

[TOC]

数据返回通用格式： 

```json
{
    "code":0,		//状态码 
    "msg":"",	//错误信息
    "data":{}		//返回数据
}
```

为了方便你们编程，所有接口都实现了get和post方法

##  机器注册接口

### 描述

由计算平台从机启动后调用，表示已经准备就绪，可以接受计算任务

### url

`/container/register`

### 参数

| 参数名 | 类型 | 注释 |
| ------ | ---- | ---- |
| ip     | String | 计算平台自己的ip |
| port   | String | 计算平台所监听的端口 |

#### 示例

```json
{
    "ip":"192.168.1.5",		
    "port":"54321"			
}
```

### 返回值

| 键 | 值类型 | 值注释 |
| --- | --- | --- |
| code | | 状态码，0表示成功 |

```json
{
    "code":0,			//
    "msg":"ok",		//信息	 
    "data":{
        "cid":1		//本机被分配的id
    }
}
```

```json
{
    "code":1,		//不成功
    "msg":"database connection failed",
    "data":{}
}
```

## 机器申请接口

### 描述

算法端需要进行计算任务时，发送此请求，申请资源。

### url

`/container/apply`

### 参数

无

### 返回值

```json
{ 
    "code":0,		//状态码  0表示成功
    "msg":"ok",		//错误信息  
    "data":{
        "cid":1,				//分配的机器id
        "pid":2,				//此次计算任务流程id
        "ip":"192.168.43.2",	//分配的机器ip
        "port":"12345",			//分配的机器port
    }
}
```

```json
{
    "code":1,		//不成功
    "msg":"insufficient resources",   //资源不足
    "data":{}
}
```

## 机器连接成功注册接口

### 描述

算法端获取到申请的机器ip port成功后

### url



### 参数



### 返回值





\2. 机器连接成功注册接口

url

/process/connect

参数：

{

​    "id":机器id

}



返回：

{  

​    "code":0,		//不成功  

​    "msg":"ok", 

​    "data":{}  

}



{ 

​    "code":1,		//不成功 

​    "msg":"database connection failed"

​    "data":{} 

}

\3. 计算完成接口 





机器注册接口
参数：(ip,port)
返回值：本机被分配的id

机器申请接口
返回值：(分配的机器id,此次计算任务流程id,分配的机器ip,分配的机器port)

机器连接成功注册接口
参数：此次计算任务流程id

机器开始计算接口
参数：(此次计算任务流程id,本计算平台机器ip)

机器计算完成接口
参数:(此次计算任务流程id,本计算平台机器ip,此次计算参数，此次计算结果)

流程结束接口
参数：(此次计算任务流程id)

获取所有计算流程信息
返回值：计算流程信息数组

获取所有机器信息
返回值：机器信息数组

获取某个计算流程状态
参数：计算流程id
返回值：状态







